# MCP Resources è¯¦è§£

## Resources æ˜¯ä»€ä¹ˆï¼Ÿ

Resources æ˜¯ MCP ä¸­çš„**æ•°æ®æš´éœ²æœºåˆ¶**ï¼Œè®© LLM èƒ½å¤Ÿ**è¯»å–**å¤–éƒ¨æ•°æ®æºã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›å¯¹æ¯”                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Tools (å·¥å…·)        Resources (èµ„æº)       Prompts (æç¤º)      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   æ‰§è¡ŒåŠ¨ä½œ             æä¾›æ•°æ®               æä¾›æ¨¡æ¿            â”‚
â”‚   å¦‚ï¼šå‘é‚®ä»¶           å¦‚ï¼šè¯»å–æ–‡ä»¶           å¦‚ï¼šä»£ç å®¡æŸ¥æç¤º      â”‚
â”‚                                                                 â”‚
â”‚   LLM ä¸»åŠ¨è°ƒç”¨         Client/ç”¨æˆ·è¯·æ±‚        ç”¨æˆ·é€‰æ‹©ä½¿ç”¨         â”‚
â”‚   æœ‰è¾“å…¥å‚æ•°           é€šè¿‡ URI è®¿é—®          å¯å¸¦å‚æ•°æ¨¡æ¿         â”‚
â”‚                                                                 â”‚
â”‚   POST æ“ä½œ            GET æ“ä½œ              æ¨¡æ¿æ¸²æŸ“             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Resources vs Tools æ ¸å¿ƒåŒºåˆ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚   Tools (å·¥å…·)                    Resources (èµ„æº)              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚                                                                â”‚
â”‚   ğŸ“§ å‘é€é‚®ä»¶                      ğŸ“„ è¯»å–é‚®ä»¶åˆ—è¡¨               â”‚
â”‚   ğŸ“ åˆ›å»ºæ–‡ä»¶                      ğŸ“– è¯»å–æ–‡ä»¶å†…å®¹               â”‚
â”‚   ğŸ—‘ï¸ åˆ é™¤è®°å½•                      ğŸ“Š è·å–æ•°æ®åº“æ•°æ®              â”‚
â”‚   ğŸ’¾ ä¿å­˜æ•°æ®                      ğŸ” æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€               â”‚
â”‚                                                                â”‚
â”‚   â†’ æœ‰å‰¯ä½œç”¨ï¼Œæ”¹å˜çŠ¶æ€              â†’ æ— å‰¯ä½œç”¨ï¼Œåªè¯»æ•°æ®          â”‚
â”‚   â†’ LLM å†³å®šä½•æ—¶è°ƒç”¨               â†’ é€šå¸¸é¢„åŠ è½½åˆ°ä¸Šä¸‹æ–‡           â”‚
â”‚   â†’ åŠ¨æ€å‚æ•°                       â†’ é€šè¿‡ URI æ ‡è¯†               â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Resources å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚    â”‚   MCP    â”‚    â”‚  æ•°æ®æº   â”‚
â”‚          â”‚    â”‚  Server  â”‚    â”‚ (æ–‡ä»¶ç­‰)  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚               â”‚               â”‚
     â”‚ 1. åˆ—å‡ºèµ„æº    â”‚               â”‚
     â”‚â”€â”€resources/listâ”€>             â”‚
     â”‚<â”€èµ„æºåˆ—è¡¨â”€â”€â”€â”€â”€â”€â”‚               â”‚
     â”‚               â”‚               â”‚
     â”‚ 2. è¯»å–èµ„æº    â”‚               â”‚
     â”‚â”€â”€resources/readâ”€>             â”‚
     â”‚               â”‚â”€â”€â”€è¯»å–æ•°æ®â”€â”€â”€â”€>â”‚
     â”‚               â”‚<â”€â”€è¿”å›æ•°æ®â”€â”€â”€â”€â”€â”‚
     â”‚<â”€èµ„æºå†…å®¹â”€â”€â”€â”€â”€â”€â”‚               â”‚
     â”‚               â”‚               â”‚
     â”‚ 3. è®¢é˜…å˜åŒ–(å¯é€‰)              â”‚
     â”‚â”€â”€resources/subscribeâ”€>        â”‚
     â”‚               â”‚               â”‚
     â”‚ 4. å˜åŒ–é€šçŸ¥    â”‚               â”‚
     â”‚<â”€notificationâ”€â”‚               â”‚
     â”‚               â”‚               â”‚
```

## ä»£ç ç¤ºä¾‹

### 1. å®šä¹‰é™æ€èµ„æº

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";

const server = new McpServer({
  name: "docs-server",
  version: "1.0.0"
});

// å®šä¹‰é™æ€èµ„æº
server.resource(
  "readme",                              // èµ„æºåç§°
  "file:///project/README.md",           // URI
  async (uri) => {
    const content = await fs.readFile("./README.md", "utf-8");
    return {
      contents: [{
        uri: uri.href,
        mimeType: "text/markdown",
        text: content
      }]
    };
  }
);

// å®šä¹‰é…ç½®æ–‡ä»¶èµ„æº
server.resource(
  "config",
  "file:///project/config.json",
  async (uri) => {
    const config = await fs.readFile("./config.json", "utf-8");
    return {
      contents: [{
        uri: uri.href,
        mimeType: "application/json",
        text: config
      }]
    };
  }
);
```

### 2. å®šä¹‰åŠ¨æ€èµ„æºæ¨¡æ¿

```typescript
// ä½¿ç”¨èµ„æºæ¨¡æ¿ - æ”¯æŒåŠ¨æ€å‚æ•°
server.resourceTemplate(
  "user-profile",
  "user://{userId}/profile",           // URI æ¨¡æ¿
  "ç”¨æˆ·ä¸ªäººèµ„æ–™",
  async (uri, { userId }) => {
    const user = await database.getUser(userId);
    return {
      contents: [{
        uri: uri.href,
        mimeType: "application/json",
        text: JSON.stringify(user)
      }]
    };
  }
);

// æ•°æ®åº“è¡¨èµ„æº
server.resourceTemplate(
  "db-table",
  "db:///{database}/{table}",
  "æ•°æ®åº“è¡¨å†…å®¹",
  async (uri, { database, table }) => {
    const data = await db.query(`SELECT * FROM ${database}.${table} LIMIT 100`);
    return {
      contents: [{
        uri: uri.href,
        mimeType: "application/json",
        text: JSON.stringify(data)
      }]
    };
  }
);
```

### 3. å®Œæ•´çš„æ–‡ä»¶ç³»ç»Ÿèµ„æºæœåŠ¡å™¨

```typescript
import { McpServer } from "@modelcontextprotocol/sdk/server/mcp.js";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import * as fs from "fs/promises";
import * as path from "path";

const server = new McpServer({
  name: "filesystem-server",
  version: "1.0.0"
});

const PROJECT_ROOT = "/path/to/project";

// ===== åˆ—å‡ºæ‰€æœ‰èµ„æº =====
server.setRequestHandler("resources/list", async () => {
  const files = await fs.readdir(PROJECT_ROOT, { recursive: true });
  
  return {
    resources: files
      .filter(file => !file.includes("node_modules"))
      .map(file => ({
        uri: `file:///${file}`,
        name: path.basename(file),
        description: `é¡¹ç›®æ–‡ä»¶: ${file}`,
        mimeType: getMimeType(file)
      }))
  };
});

// ===== è¯»å–å•ä¸ªèµ„æº =====
server.setRequestHandler("resources/read", async (request) => {
  const uri = new URL(request.params.uri);
  const filePath = path.join(PROJECT_ROOT, uri.pathname);
  
  // å®‰å…¨æ£€æŸ¥
  if (!filePath.startsWith(PROJECT_ROOT)) {
    throw new Error("Access denied");
  }
  
  const content = await fs.readFile(filePath, "utf-8");
  
  return {
    contents: [{
      uri: request.params.uri,
      mimeType: getMimeType(filePath),
      text: content
    }]
  };
});

// ===== è®¢é˜…èµ„æºå˜åŒ– =====
server.setRequestHandler("resources/subscribe", async (request) => {
  const uri = request.params.uri;
  
  // ç›‘å¬æ–‡ä»¶å˜åŒ–
  const filePath = new URL(uri).pathname;
  fs.watch(path.join(PROJECT_ROOT, filePath), () => {
    // å‘é€é€šçŸ¥
    server.notification({
      method: "notifications/resources/updated",
      params: { uri }
    });
  });
  
  return {};
});

function getMimeType(filename: string): string {
  const ext = path.extname(filename);
  const mimeTypes: Record<string, string> = {
    ".ts": "text/typescript",
    ".js": "text/javascript",
    ".json": "application/json",
    ".md": "text/markdown",
    ".html": "text/html",
    ".css": "text/css",
  };
  return mimeTypes[ext] || "text/plain";
}

// å¯åŠ¨æœåŠ¡å™¨
const transport = new StdioServerTransport();
await server.connect(transport);
```

### 4. Client ç«¯ä½¿ç”¨èµ„æº

```typescript
import { Client } from "@modelcontextprotocol/sdk/client/index.js";

class ResourceClient {
  private client: Client;

  // è·å–æ‰€æœ‰å¯ç”¨èµ„æº
  async listResources() {
    const response = await this.client.listResources();
    
    console.log("å¯ç”¨èµ„æº:");
    response.resources.forEach(r => {
      console.log(`  - ${r.name}: ${r.uri}`);
    });
    
    return response.resources;
  }

  // è¯»å–ç‰¹å®šèµ„æº
  async readResource(uri: string) {
    const response = await this.client.readResource({ uri });
    return response.contents[0];
  }

  // å°†èµ„æºå†…å®¹æ³¨å…¥åˆ° LLM ä¸Šä¸‹æ–‡
  async chatWithResources(userMessage: string, resourceUris: string[]) {
    // 1. è¯»å–æ‰€æœ‰éœ€è¦çš„èµ„æº
    const resourceContents = await Promise.all(
      resourceUris.map(uri => this.readResource(uri))
    );

    // 2. æ„å»ºä¸Šä¸‹æ–‡æ¶ˆæ¯
    const contextMessage = resourceContents
      .map(r => `--- ${r.uri} ---\n${r.text}`)
      .join("\n\n");

    // 3. å‘é€ç»™ LLM
    const response = await anthropic.messages.create({
      model: "claude-sonnet-4-20250514",
      max_tokens: 2048,
      messages: [
        {
          role: "user",
          content: `ä»¥ä¸‹æ˜¯ç›¸å…³èµ„æºå†…å®¹ï¼š\n\n${contextMessage}\n\nç”¨æˆ·é—®é¢˜ï¼š${userMessage}`
        }
      ]
    });

    return response;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const client = new ResourceClient();

// åˆ—å‡ºæ‰€æœ‰èµ„æº
const resources = await client.listResources();
// è¾“å‡º:
// å¯ç”¨èµ„æº:
//   - README.md: file:///README.md
//   - config.json: file:///config.json
//   - index.ts: file:///src/index.ts

// è¯»å–ç‰¹å®šèµ„æº
const readme = await client.readResource("file:///README.md");
console.log(readme.text);

// å¸¦èµ„æºä¸Šä¸‹æ–‡çš„å¯¹è¯
const answer = await client.chatWithResources(
  "è¿™ä¸ªé¡¹ç›®æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ",
  ["file:///README.md", "file:///package.json"]
);
```

## å®é™…åº”ç”¨åœºæ™¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Resources åº”ç”¨åœºæ™¯                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“ æ–‡ä»¶ç³»ç»Ÿ                                                     â”‚
â”‚     file:///project/src/index.ts                                â”‚
â”‚     â†’ è®© LLM è¯»å–ä»£ç æ–‡ä»¶è¿›è¡Œåˆ†æ                                 â”‚
â”‚                                                                 â”‚
â”‚  ğŸ—„ï¸ æ•°æ®åº“                                                       â”‚
â”‚     db:///mydb/users                                            â”‚
â”‚     â†’ æš´éœ²æ•°æ®åº“è¡¨ç»“æ„å’Œç¤ºä¾‹æ•°æ®                                  â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“Š API æ•°æ®                                                     â”‚
â”‚     api:///github/repos/owner/repo                              â”‚
â”‚     â†’ æä¾› API å“åº”æ•°æ®ä¾›åˆ†æ                                     â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ æ–‡æ¡£                                                         â”‚
â”‚     docs:///api-reference                                       â”‚
â”‚     â†’ æä¾›äº§å“æ–‡æ¡£ä½œä¸ºä¸Šä¸‹æ–‡                                      â”‚
â”‚                                                                 â”‚
â”‚  ğŸ”§ é…ç½®                                                         â”‚
â”‚     config:///app/settings                                      â”‚
â”‚     â†’ æä¾›ç³»ç»Ÿé…ç½®ä¿¡æ¯                                           â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ˆ ç›‘æ§æ•°æ®                                                     â”‚
â”‚     metrics:///server/cpu                                       â”‚
â”‚     â†’ æä¾›ç³»ç»Ÿç›‘æ§æ•°æ®                                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¸ Tools é…åˆä½¿ç”¨

```typescript
const server = new McpServer({ name: "project-server", version: "1.0.0" });

// ===== Resources: åªè¯»è®¿é—® =====
server.resource(
  "source-code",
  "file:///src/main.ts",
  async () => ({
    contents: [{
      uri: "file:///src/main.ts",
      text: await fs.readFile("./src/main.ts", "utf-8")
    }]
  })
);

// ===== Tools: å†™å…¥æ“ä½œ =====
server.tool(
  "update_file",
  "æ›´æ–°æ–‡ä»¶å†…å®¹",
  {
    path: { type: "string", description: "æ–‡ä»¶è·¯å¾„" },
    content: { type: "string", description: "æ–°å†…å®¹" }
  },
  async ({ path, content }) => {
    await fs.writeFile(path, content);
    return {
      content: [{ type: "text", text: `æ–‡ä»¶ ${path} å·²æ›´æ–°` }]
    };
  }
);
```

```
å…¸å‹å·¥ä½œæµï¼š

1. Client è¯»å– Resources â†’ ä»£ç æ–‡ä»¶å†…å®¹
2. å‘é€ç»™ LLMï¼š"è¯·ä¼˜åŒ–è¿™æ®µä»£ç "
3. LLM åˆ†æåè°ƒç”¨ Tool â†’ update_file
4. æ–‡ä»¶è¢«æ›´æ–°

Resources = è¯»å–æ•°æ® (GET)
Tools = æ‰§è¡Œæ“ä½œ (POST/PUT/DELETE)
```

## æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Resources æ ¸å¿ƒè¦ç‚¹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  âœ… ç”¨é€”ï¼šæš´éœ²åªè¯»æ•°æ®ç»™ LLM                                     â”‚
â”‚                                                                â”‚
â”‚  âœ… ç‰¹ç‚¹ï¼š                                                       â”‚
â”‚     â€¢ é€šè¿‡ URI æ ‡è¯† (file://, db://, api://)                    â”‚
â”‚     â€¢ æ”¯æŒé™æ€èµ„æºå’ŒåŠ¨æ€æ¨¡æ¿                                     â”‚
â”‚     â€¢ å¯è®¢é˜…å˜åŒ–é€šçŸ¥                                            â”‚
â”‚     â€¢ æ— å‰¯ä½œç”¨ï¼Œå®‰å…¨çš„æ•°æ®è®¿é—®                                   â”‚
â”‚                                                                â”‚
â”‚  âœ… ä¸ Tools åŒºåˆ«ï¼š                                              â”‚
â”‚     â€¢ Resources = è¯»å–æ•°æ®                                      â”‚
â”‚     â€¢ Tools = æ‰§è¡Œæ“ä½œ                                          â”‚
â”‚                                                                â”‚
â”‚  âœ… å…¸å‹åœºæ™¯ï¼š                                                   â”‚
â”‚     â€¢ æ–‡ä»¶å†…å®¹ã€æ•°æ®åº“æ•°æ®ã€API å“åº”                             â”‚
â”‚     â€¢ ä½œä¸º LLM å¯¹è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯                                  â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

